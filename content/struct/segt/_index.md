---
title: セグメント木
version: 1.0
prefix: $segt
---

{{< meta >}}

区間に対する演算を高速に処理するデータ構造です。

## 説明
配列 $A$ に対して、要素の更新と結合律を満たす区間に対する演算を何回も処理する場合に有用なデータ構造です。
通常の配列の場合、要素の更新は容易に $O(1)$ で処理できますが、区間に対する演算の計算量はその区間の長さに比例します。
セグメント木は、要素の更新を $O(\log |A|)$ とする代わりに、区間に対する演算の計算量をその区間の長さの対数に抑えます。

## データ構造

### ジェネリクス
$T$

### 状態空間
- $n' \in \mathbb{Z}_{\geq 0}$
- $f'$: 結合的かつ単位元が存在する $T^2 \rightarrow T$
- $e'$: $f'$ の単位元 $e' \in T$
- $A' = (A_{0}', \ldots, A_{n' - 1}') \in T^{n'}$

$f'$ は区間に適用する演算に対応します。
$A'$ は配列の各要素の状態に対応します。この配列は0-indexedです。

### コンストラクタ
要素数 $n$ のセグメント木を初期化します。要素数は2のべき乗である必要はありません。
セグメント木の区間に対する演算とその演算における単位元も初期化時に指定します。
セグメント木の各要素は単位元で初期化されます。

#### 引数
- $n \in \mathbb{Z}_{\geq 0}$
- $e$: $f$ の単位元 $e \in T$
- $f$: 結合的かつ単位元が存在する $T^2 \rightarrow T$

#### 初期状態
- $n' = n$
- $f' = f$
- $e' = e$
- $A' = (e, \ldots, e)$

#### 計算量
$O(n)$

### update
指定した要素の値を更新します。指定するインデックスは0-indexedです。

#### 引数
- $i \in \\{0, 1, \ldots, n' - 1\\}$
- $x \in T$

#### 戻り値
なし

#### 状態変化
$A'_{i} \leftarrow x$

#### 計算量
$O(\log{n'})$

### query
指定した区間に対する演算結果を返します。区間は左閉右開区間であり、インデックスは0-indexedです。

#### 引数
- $i \in \\{0, 1, \ldots, n' - 1\\}$
- $j \in \\{0, 1, \ldots, n'\\}$

#### 戻り値
$f(f( \ldots f(f(A_{i}', A_{i + 1}'), A_{i + 2}') \ldots), A_{j - 1}')$

#### 状態変化
なし

#### 計算量
$O(\log{n'})$

{{< src >}}

{{< example >}}
